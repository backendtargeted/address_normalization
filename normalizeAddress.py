#Normalize the address sufix of a csv

import pandas as pd
import csv
import os
import re

# Your comprehensive abbreviation map
abbreviation_map = {
"Find" : "Replace", "Apartment" : "Apt", "Basement" : "Bsmt", "Building" : "Bldg", "Department" : "Dept", "Floor" : "Fl", "Front" : "Frnt", "Hanger" : "Hngr", "Key" : "Key", "Lobby" : "Lbby", "Lot" : "Lot", "Lower" : "Lowr", "Office" : "Ofc", "Penthouse" : "Ph", "Pier" : "Pier", "Rear" : "Rear", "Room" : "Rm", "Side" : "Side", "Slip" : "Slip", "Space" : "Spc", "Stop" : "Stop", "Suite" : "Ste", "Trailer" : "Trlr", "Unit" : "Unit", "Upper" : "Uppr", "Allee" : "Aly", "Alley" : "Aly", "Ally" : "Aly", "Aly" : "Aly", "Anex" : "Anx", "Annex" : "Anx", "Annx" : "Anx", "Anx" : "Anx", "Arc" : "Arc", "Arcade" : "Arc", "Av" : "Ave", "Ave" : "Ave", "Aven" : "Ave", "Avenu" : "Ave", "Avenue" : "Ave", "Avn" : "Ave", "Avnue" : "Ave", "Bayoo" : "Byu", "Bayou" : "Byu", "Bch" : "Bch", "Beach" : "Bch", "Bend" : "Bnd", "Bnd" : "Bnd", "Blf" : "Blf", "Bluf" : "Blf", "Bluff" : "Blf", "Bluffs" : "Blfs", "Bot" : "Btm", "Btm" : "Btm", "Bottm" : "Btm", "Bottom" : "Btm", "Blvd" : "Blvd", "Boul" : "Blvd", "Boulevard" : "Blvd", "Boulv" : "Blvd", "Br" : "Br", "Brnch" : "Br", "Branch" : "Br", "Brdge" : "Brg", "Brg" : "Brg", "Bridge" : "Brg", "Brk" : "Brk", "Brook" : "Brk", "Brooks" : "Brks", "Burg" : "Bg", "Burgs" : "Bgs", "Byp" : "Byp", "Bypa" : "Byp", "Bypas" : "Byp", "Bypass" : "Byp", "Byps" : "Byp", "Camp" : "Cp", "Cp" : "Cp", "Cmp" : "Cp", "Canyn" : "Cyn", "Canyon" : "Cyn", "Cnyn" : "Cyn", "Cape" : "Cpe", "Cpe" : "Cpe", "Causeway" : "Cswy", "Causwa" : "Cswy", "Cswy" : "Cswy", "Cen" : "Ctr", "Cent" : "Ctr", "Center" : "Ctr", "Centr" : "Ctr", "Centre" : "Ctr", "Cnter" : "Ctr", "Cntr" : "Ctr", "Ctr" : "Ctr", "Centers" : "Ctrs", "Cir" : "Cir", "Circ" : "Cir", "Circl" : "Cir", "Circle" : "Cir", "Crcl" : "Cir", "Crcle" : "Cir", "Circles" : "Cirs", "Clf" : "Clf", "Cliff" : "Clf", "Clfs" : "Clfs", "Cliffs" : "Clfs", "Clb" : "Clb", "Club" : "Clb", "Common" : "Cmn", "Commons" : "Cmns", "Cor" : "Cor", "Corner" : "Cor", "Corners" : "Cors", "Cors" : "Cors", "Course" : "Crse", "Crse" : "Crse", "Court" : "Ct", "Ct" : "Ct", "Courts" : "Cts", "Cts" : "Cts", "Cove" : "Cv", "Cv" : "Cv", "Coves" : "Cvs", "Creek" : "Crk", "Crk" : "Crk", "Crescent" : "Cres", "Cres" : "Cres", "Crsent" : "Cres", "Crsnt" : "Cres", "Crest" : "Crst", "Crossing" : "Xing", "Crssng" : "Xing", "Xing" : "Xing", "Crossroad" : "Xrd", "Crossroads" : "Xrds", "Curve" : "Curv", "Dale" : "Dl", "Dl" : "Dl", "Dam" : "Dm", "Dm" : "Dm", "Div" : "Dv", "Divide" : "Dv", "Dv" : "Dv", "Dvd" : "Dv", "Dr" : "Dr", "Driv" : "Dr", "Drive" : "Dr", "Drv" : "Dr", "Drives" : "Drs", "Est" : "Est", "Estate" : "Est", "Estates" : "Ests", "Ests" : "Ests", "Exp" : "Expy", "Expr" : "Expy", "Express" : "Expy", "Expressway" : "Expy", "Expw" : "Expy", "Expy" : "Expy", "Ext" : "Ext", "Extension" : "Ext", "Extn" : "Ext", "Extnsn" : "Ext", "Exts" : "Exts", "Fall" : "Fall", "Falls" : "Fls", "Fls" : "Fls", "Ferry" : "Fry", "Frry" : "Fry", "Fry" : "Fry", "Field" : "Fld", "Fld" : "Fld", "Fields" : "Flds", "Flds" : "Flds", "Flat" : "Flt", "Flt" : "Flt", "Flats" : "Flts", "Flts" : "Flts", "Ford" : "Frd", "Frd" : "Frd", "Fords" : "Frds", "Forest" : "Frst", "Forests" : "Frst", "Frst" : "Frst", "Forg" : "Frg", "Forge" : "Frg", "Frg" : "Frg", "Forges" : "Frgs", "Fork" : "Frk", "Frk" : "Frk", "Forks" : "Frks", "Frks" : "Frks", "Fort" : "Ft", "Frt" : "Ft", "Ft" : "Ft", "Freeway" : "Fwy", "Freewy" : "Fwy", "Frway" : "Fwy", "Frwy" : "Fwy", "Fwy" : "Fwy", "Garden" : "Gdn", "Gardn" : "Gdn", "Grden" : "Gdn", "Grdn" : "Gdn", "Gardens" : "Gdns", "Gdns" : "Gdns", "Grdns" : "Gdns", "Gateway" : "Gtwy", "Gatewy" : "Gtwy", "Gatway" : "Gtwy", "Gtway" : "Gtwy", "Gtwy" : "Gtwy", "Glen" : "Gln", "Gln" : "Gln", "Glens" : "Glns", "Green" : "Grn", "Grn" : "Grn", "Greens" : "Grns", "Grov" : "Grv", "Grove" : "Grv", "Grv" : "Grv", "Groves" : "Grvs", "Harb" : "Hbr", "Harbor" : "Hbr", "Harbr" : "Hbr", "Hbr" : "Hbr", "Hrbor" : "Hbr", "Harbors" : "Hbrs", "Haven" : "Hvn", "Hvn" : "Hvn", "Ht" : "Hts", "Hts" : "Hts", "Highway" : "Hwy", "Highwy" : "Hwy", "Hiway" : "Hwy", "Hiwy" : "Hwy", "Hway" : "Hwy", "Hwy" : "Hwy", "Hill" : "Hl", "Hl" : "Hl", "Hills" : "Hls", "Hls" : "Hls", "Hllw" : "Holw", "Hollow" : "Holw", "Hollows" : "Holw", "Holw" : "Holw", "Holws" : "Holw", "Inlt" : "Inlt", "Is" : "Is", "Island" : "Is", "Islnd" : "Is", "Islands" : "Iss", "Islnds" : "Iss", "Iss" : "Iss", "Isle" : "Isle", "Isles" : "Isle", "Jct" : "Jct", "Jction" : "Jct", "Jctn" : "Jct", "Junction" : "Jct", "Junctn" : "Jct", "Juncton" : "Jct", "Jctns" : "Jcts", "Jcts" : "Jcts", "Junctions" : "Jcts", "Key" : "Ky", "Ky" : "Ky", "Keys" : "Kys", "Kys" : "Kys", "Knl" : "Knl", "Knol" : "Knl", "Knoll" : "Knl", "Knls" : "Knls", "Knolls" : "Knls", "Lk" : "Lk", "Lake" : "Lk", "Lks" : "Lks", "Lakes" : "Lks", "Land" : "Land", "Landing" : "Lndg", "Lndg" : "Lndg", "Lndng" : "Lndg", "Lane" : "Ln", "Ln" : "Ln", "Lgt" : "Lgt", "Light" : "Lgt", "Lights" : "Lgts", "Lf" : "Lf", "Loaf" : "Lf", "Lck" : "Lck", "Lock" : "Lck", "Lcks" : "Lcks", "Locks" : "Lcks", "Ldg" : "Ldg", "Ldge" : "Ldg", "Lodg" : "Ldg", "Lodge" : "Ldg", "Loop" : "Loop", "Loops" : "Loop", "Mall" : "Mall", "Mnr" : "Mnr", "Manor" : "Mnr", "Manors" : "Mnrs", "Mnrs" : "Mnrs", "Meadow" : "Mdw", "Mdw" : "Mdws", "Mdws" : "Mdws", "Meadows" : "Mdws", "Medows" : "Mdws", "Mews" : "Mews", "Mill" : "Ml", "Mills" : "Mls", "Missn" : "Msn", "Mssn" : "Msn", "Motorway" : "Mtwy", "Mnt" : "Mt", "Mt" : "Mt", "Mount" : "Mt", "Mntain" : "Mtn", "Mntn" : "Mtn", "Mountain" : "Mtn", "Mountin" : "Mtn", "Mtin" : "Mtn", "Mtn" : "Mtn", "Mntns" : "Mtns", "Mountains" : "Mtns", "Nck" : "Nck", "Neck" : "Nck", "Orch" : "Orch", "Orchard" : "Orch", "Orchrd" : "Orch", "Oval" : "Oval", "Ovl" : "Oval", "Overpass" : "Opas", "Park" : "Park", "Prk" : "Park", "Parks" : "Park", "Parkway" : "Pkwy", "Parkwy" : "Pkwy", "Pkway" : "Pkwy", "Pkwy" : "Pkwy", "Pky" : "Pkwy", "Parkways" : "Pkwy", "Pkwys" : "Pkwy", "Pass" : "Pass", "Passage" : "Psge", "Path" : "Path", "Paths" : "Path", "Pike" : "Pike", "Pikes" : "Pike", "Pine" : "Pne", "Pines" : "Pnes", "Pnes" : "Pnes", "Pl" : "Pl", "Plain" : "Pln", "Pln" : "Pln", "Plains" : "Plns", "Plns" : "Plns", "Plaza" : "Plz", "Plz" : "Plz", "Plza" : "Plz", "Point" : "Pt", "Pt" : "Pt", "Points" : "Pts", "Pts" : "Pts", "Port" : "Prt", "Prt" : "Prt", "Ports" : "Prts", "Prts" : "Prts", "Pr" : "Pr", "Prairie" : "Pr", "Prr" : "Pr", "Rad" : "Radl", "Radial" : "Radl", "Radiel" : "Radl", "Radl" : "Radl", "Ramp" : "Ramp", "Ranch" : "Rnch", "Ranches" : "Rnch", "Rnch" : "Rnch", "Rnchs" : "Rnch", "Rapid" : "Rpd", "Rpd" : "Rpd", "Rapids" : "Rpds", "Rpds" : "Rpds", "Rest" : "Rst", "Rst" : "Rst", "Rdg" : "Rdg", "Rdge" : "Rdg", "Ridge" : "Rdg", "Rdgs" : "Rdgs", "Ridges" : "Rdgs", "Riv" : "Riv", "River" : "Riv", "Rvr" : "Riv", "Rivr" : "Riv", "Rd" : "Rd", "Road" : "Rd", "Roads" : "Rds", "Rds" : "Rds", "Route" : "Rte", "Row" : "Row", "Rue" : "Rue", "Run" : "Run", "Shl" : "Shl", "Shoal" : "Shl", "Shls" : "Shls", "Shoals" : "Shls", "Shoar" : "Shr", "Shore" : "Shr", "Shr" : "Shr", "Shoars" : "Shrs", "Shores" : "Shrs", "Shrs" : "Shrs", "Skyway" : "Skwy", "Spg" : "Spg", "Spng" : "Spg", "Spring" : "Spg", "Sprng" : "Spg", "Spgs" : "Spgs", "Spngs" : "Spgs", "Springs" : "Spgs", "Sprngs" : "Spgs", "Spur" : "Spur", "Spurs" : "Spur", "Sq" : "Sq", "Sqr" : "Sq", "Sqre" : "Sq", "Squ" : "Sq", "Square" : "Sq", "Sqrs" : "Sqs", "Squares" : "Sqs", "Sta" : "Sta", "Station" : "Sta", "Statn" : "Sta", "Stn" : "Sta", "Stra" : "Stra", "Strav" : "Stra", "Straven" : "Stra", "Stravenue" : "Stra", "Stravn" : "Stra", "Strvn" : "Stra", "Strvnue" : "Stra", "Stream" : "Strm", "Streme" : "Strm", "Strm" : "Strm", "Street" : "St", "Strt" : "St", "St" : "St", "Str" : "St", "Streets" : "Sts", "Smt" : "Smt", "Sumit" : "Smt", "Sumitt" : "Smt", "Summit" : "Smt", "Ter" : "Ter", "Terr" : "Ter", "Terrace" : "Ter", "Throughway" : "Trwy", "Trace" : "Trce", "Traces" : "Trce", "Trce" : "Trce", "Track" : "Trak", "Tracks" : "Trak", "Trak" : "Trak", "Trk" : "Trak", "Trks" : "Trak", "Trafficway" : "Trfy", "Trail" : "Trl", "Trails" : "Trl", "Trl" : "Trl", "Trls" : "Trl", "Trailer" : "Trlr", "Trlr" : "Trlr", "Trlrs" : "Trlr", "Tunel" : "Tunl", "Tunl" : "Tunl", "Tunls" : "Tunl", "Tunnel" : "Tunl", "Tunnels" : "Tunl", "Tunnl" : "Tunl", "Trnpk" : "Tpke", "Turnpike" : "Tpke", "Turnpk" : "Tpke", "Underpass" : "Upas", "Un" : "Un", "Union" : "Un", "Unions" : "Uns", "Valley" : "Vly", "Vally" : "Vly", "Vlly" : "Vly", "Vly" : "Vly", "Valleys" : "Vlys", "Vlys" : "Vlys", "Vdct" : "Via", "Via" : "Via", "Viadct" : "Via", "Viaduct" : "Via", "View" : "Vw", "Vw" : "Vw", "Views" : "Vws", "Vws" : "Vws", "Vill" : "Vlg", "Villag" : "Vlg", "Village" : "Vlg", "Villg" : "Vlg", "Villiage" : "Vlg", "Vlg" : "Vlg", "Villages" : "Vlgs", "Vlgs" : "Vlgs", "Ville" : "Vl", "Vl" : "Vl", "Vis" : "Vis", "Vist" : "Vis", "Vista" : "Vis", "Vst" : "Vis", "Vsta" : "Vis", "Walk" : "Walk", "Walks" : "Walk", "Wall" : "Wall", "Wy" : "Way", "Way" : "Way", "Ways" : "Ways", "Well" : "Wl", "Wells" : "Wls", "Wls" : "Wls"
        }

def replace_address_parts(address):
    for original, replacement in abbreviation_map.items():
        pattern = r"\b" + re.escape(original) + r"\b"  # Word boundary pattern
        address = re.sub(pattern, replacement, address, flags=re.IGNORECASE) 
    return address

def process_csv(input_filename, output_filename):
    # Address Processing
    addressColumn = input('Enter the address column name: ')

    with open(input_filename, 'r') as infile, open(output_filename, 'w', newline='') as outfile:
        reader = csv.DictReader(infile)
        writer = csv.DictWriter(outfile, fieldnames=reader.fieldnames) 
        writer.writeheader()

        for row in reader:

            # Address Normalization
            address = row.get(addressColumn, '')  # Handle potential missing values
            row[addressColumn] = replace_address_parts(address) 

            writer.writerow(row)

# Example usage
input_file_name = input('Enter the name of the file: ')
input_file = f'C://Users//USER//Downloads//Probates June 2024//Normalized Address//Probates NY Suffolk 06-2024.csv'
output_file = f'C://Users//USER//Downloads//Probates June 2024//Normalized Address//Probates NY Suffolk 06-2024-processed.csv'
process_csv(input_file, output_file) 


